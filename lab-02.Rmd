---
title: "Lab 02 - Plastic waste"
author: "Yiwei Tang"
date: "1/25/2026"
output: github_document
---

## Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
```

```{r load-data, message=FALSE}
plastic_waste <- read.csv("data/plastic-waste.csv")
```

## Exercises

### Exercise 1

The country of the highest plastic waste per capita is located in North America. Overall, it seems like North America has more countries with comparitively higher plastic waste per capita than other continents.

```{r plastic-waste-continent}
ggplot(
  data = plastic_waste,
  aes(x = plastic_waste_per_cap)
) +
  geom_histogram() +
  facet_wrap(~ continent) +
  labs(x = "Plastic Waste Per Capita", y = "Count of Countries")
```

### Exercise 2

We defined the color and fill of the curves by mapping aesthetics of the plot but defined the alpha level as a characteristic of the plotting geom because we want to have different colors and fills for different continents, while the alpha level to be the same across all continents. Mapping aesthetics allows us to assign unique features to each category, while geom allows us to assign the same feature to all cagtegories.

```{r plastic-waste-density}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = plastic_waste_per_cap,
    color = continent,
    fill = continent
  )
) +
  geom_density(alpha = 0.3)
```

### Exercise 3

Violin plots reveal the number of observations at each level with the width of the body. On the other hand, box plots shows the percentiles and outliers more clearly.

```{r plastic-waste-violin}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = continent,
    y = plastic_waste_per_cap
  )
) +
  geom_violin()
```

### Exercise 4

Plastic waste per capita and mismanaged plastic waste per capita looks like they are positively correlated.

```{r plastic-waste-mismanaged}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = plastic_waste_per_cap,
    y = mismanaged_plastic_waste_per_cap,
  )
) +
  geom_point()
```

There appeared to be some distinctions between continents in terms of the association between plastic waste per capita and mismanaged plastic waste per capita. Africa has a much clearer and steeper slop compared to other continents.

```{r plastic-waste-mismanaged-continent}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = plastic_waste_per_cap,
    y = mismanaged_plastic_waste_per_cap,
    color = continent
  )
) +
  geom_point()
```

Plastic waste per capita does not appeared to be linearly correlated with total population nor costal population.

```{r plastic-waste-population-total}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = plastic_waste_per_cap,
    y = total_pop
  )
) +
  geom_point()
```

```{r plastic-waste-population-coastal}
ggplot(
  data = plastic_waste,
  mapping = aes(
    x = plastic_waste_per_cap,
    y = coastal_pop
  )
) +
  geom_point()
```

### Exercise 5

There seems to be a weak positive correlation between coastal population proportion and plastic waste per capita. It is hard to tell whether continent plays a role in this relationship.

```{r recreate-viz}
plastic.data <- filter(plastic_waste, plastic_waste_per_cap < 3)
plastic.data$coastal_proportion <- plastic.data$coastal_pop/plastic.data$total_pop
ggplot(
  data = plastic.data,
  mapping = aes(
    x = coastal_proportion,
    y = plastic_waste_per_cap,
    color = continent)
) +
geom_point() +
geom_smooth(color = "black") +
scale_color_viridis_d() +
labs(
  x = "Costal population proportion (Costal / total population)",
  y = "Plastic waste per capita",
  title = "Pastic waste vs. coastal population proportion",
  subtitle = "by continent",
  color = "Continent"
) +
theme(
    legend.key = element_rect(fill = "transparent"),
    panel.background = element_rect(fill = "transparent"),
    panel.grid = element_line(color = "gray90")
)

```


